​		在第一次做数值稳定时，计算$B(\text{nwrap}, 0)$，之后进行
$$
B(\text{nwrap}, 0) = Q_1R_1 = Q_1 \tilde{R} P = Q_1 D_1 T_1
$$
其中我们将$R$拆成对角元从大到小排列的矩阵$\tilde{R}$和置换矩阵$P$，之后将乘积$\tilde{R} P$进行进一步的拆解，变成对角元矩阵$D_1$和$T_1$的乘积

​		在之后进行第二次数值稳定时，首先我们会先计算乘积$B(2\text{nwrap}, \text{nwrap}) Q_1 D_1$，虽然我们已经令$D_1$成为对角元从大到小排列的对角矩阵，但是由于$B(2\text{nwrap}, \text{nwrap}) Q_1$自身的元素，它们的乘积仍然可能是元素大小排列混乱的。此时我们按照列的norm大小，将$B(2\text{nwrap}, \text{nwrap}) Q_1 D_1$进一步排列，即：
$$
B(2\text{nwrap}, \text{nwrap}) Q_1 D_1 = AP
$$
其中$A$就是一个按照norm排列好的矩阵，$P$是相应的置换矩阵。之后我们对$A$矩阵使用QR分解得到
$$
B(2\text{nwrap}, \text{nwrap}) Q_1 D_1 = AP = Q_2 R_2 P
$$
​		由于我们已经进行了列矩阵的排列，此时的$R_2$矩阵是自动排列好的，只需要调用不用排序的QR分解即可，这可以节省我们的时间

​		之后继续执行之前的操作，将$R_2$的对角元拆分出来得到：
$$
B(2\text{nwrap}, \text{nwrap}) Q_1 D_1 T_1 = AP T_1 = Q_2 R_2 P T_1 = Q_2 D_2 T_2
$$
其中$T_2 = D_2^{-1} R_2 P T_2$

​		对于之后的数值稳定，遵循与第二次数值稳定相同的步骤

